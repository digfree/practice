{"version":3,"sources":["test.js"],"names":["dataMock","name","children","url","show","DelItem","Vue","extend","props","template","data","startX","moveX","disX","methods","computeStyle","result","_touchStart","current","ev","event","w","this","$refs","remove","offsetWidth","_this","touches","length","style","match","String","preventDefault","item1","forEach","item","$set","clientX","_touchMove","_touchEnd","changedTouches","endX","deleteItem","index","splice","component","el","dataList","mounted","item2","resetDelStatus","item3","Number","toggle","toggle2"],"mappings":"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","file":"main.min.js","sourcesContent":["var dataMock = [\r\n  {\r\n    name: 2018,\r\n    children: [\r\n      {\r\n        name: \"2018-01\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"//baidu.com\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"//baidu.com\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        name: \"2018-02\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"//baidu.com\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"//baidu.com\"\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    name: 2017,\r\n    children: [\r\n      {\r\n        show: false,\r\n        name: \"2017-01\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"#\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"#\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        name: \"2017-02\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"#\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"#\"\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n];\r\n\r\nvar DelItem = Vue.extend({\r\n  props: ['item1', 'item2', 'index2'],\r\n  template: '<li ref=\"currentItem\">'\r\n    + '<a :href=\"item2.url\">'\r\n    + '<span class=\"del-btn\" @click.prevent=\"deleteItem(item1.children,index2)\" ref=\"remove\">删除</span>'\r\n    + '<p'\r\n    + '@touchstart=\"_touchStart(item2)\"'\r\n    + '@touchmove.prevent=\"_touchMove(item2)\"'\r\n    + '@touchend=\"_touchEnd(item2)\"'\r\n    + ':style=\"item2.style\">'\r\n    + '{{item2.name}}'\r\n    + '</p>'\r\n    + '</a>'\r\n    + '</li>',\r\n  data: function () {\r\n    return {\r\n      startX: 0, //触摸位置\r\n      moveX: 0, //滑动时的位置\r\n      disX: 0, //移动距离\r\n    };\r\n  },\r\n  methods: {\r\n    computeStyle: function (result) {\r\n      return 'transform: translateX(' + result + 'px)';\r\n    },\r\n    _touchStart: function (current) {\r\n      var ev = ev || event;\r\n      var w = this.$refs.remove.offsetWidth;\r\n      var _this = this;\r\n      if (ev.touches.length == 1) {\r\n        if (typeof current.style != 'undefined' && current.style != null && current.style.match(/\\d+/)[0] == String(w)) ev.preventDefault();\r\n        this.item1.children.forEach(function (item) {\r\n          if(item == current) return false;\r\n          if (typeof item.style != 'undefined' && item.style != null && item.style.match(/\\d+/)[0] == String(w)) {\r\n            _this.$set(item,'style',_this.computeStyle('0'));\r\n            ev.preventDefault();\r\n          }\r\n        });\r\n        this.startX = ev.touches[0].clientX;\r\n      }\r\n    },\r\n    _touchMove: function (current) {\r\n      var ev = ev || event;\r\n      var w = this.$refs.remove.offsetWidth;\r\n      if (ev.touches.length == 1) {\r\n        this.moveX = ev.touches[0].clientX;\r\n        this.disX = this.startX - this.moveX;\r\n        if (this.disX < 0 || this.disX == 0) {\r\n          this.$set(current,'style',this.computeStyle('0'));\r\n        } else {\r\n          this.$set(current,'style',this.computeStyle('-' + this.disX));\r\n          if (this.disX >= w) {\r\n            this.$set(current,'style',this.computeStyle('-' + w));\r\n          }\r\n        }\r\n      }\r\n    },\r\n    _touchEnd: function (current) {\r\n      var ev = ev || event;\r\n      var w = this.$refs.remove.offsetWidth;\r\n      if (ev.changedTouches.length == 1) {\r\n        var endX = ev.changedTouches[0].clientX;\r\n        this.disX = this.startX - endX;\r\n        if (this.disX < w / 2) {\r\n          this.$set(current,'style',this.computeStyle('0'));\r\n        } else {\r\n          this.$set(current,'style',this.computeStyle('-' + w));\r\n        }\r\n      }\r\n    },\r\n    deleteItem: function (item, index) {\r\n      item.splice(index, 1);\r\n    }\r\n  }\r\n});\r\n\r\nVue.component('del-item', DelItem);  //注册全局组件del-item\r\n\r\nnew Vue({\r\n  el: \"#el\",\r\n  data: {\r\n    dataList: [],\r\n  },\r\n  \r\n  mounted: function () {\r\n    var _this = this;\r\n    this.dataList = dataMock;\r\n    this.dataList.forEach(function (item) {\r\n      _this.$set(item, 'show', false);\r\n      item.children.forEach(function (item2) {\r\n        _this.$set(item2, 'show', false);\r\n      });\r\n    });\r\n    \r\n  },\r\n  methods: {\r\n    resetDelStatus: function () {\r\n      var _this = this;\r\n      this.dataList.forEach(function (item) {\r\n        item.children.forEach(function (item2) {\r\n          item2.children.forEach(function (item3) {\r\n            if(typeof item3.style != 'undefined' && Number(item3.style.match(/\\d+/)) != 0){\r\n              _this.$set(item3, 'style', 'transform: translateX(0px)');\r\n            }\r\n          });\r\n        });\r\n      });\r\n    },\r\n    toggle: function (current) {\r\n      this.dataList.forEach(function (item) {\r\n        if (item == current) {\r\n          item.show = !item.show;\r\n        } else {\r\n          item.show = false;\r\n        }\r\n        item.children.forEach(function (item2) {\r\n          if (item2.show) {\r\n            item2.show = false;\r\n          }\r\n        });\r\n      });\r\n      this.resetDelStatus();\r\n    },\r\n    toggle2(current) {\r\n      this.dataList.forEach(function (item) {\r\n        item.children.forEach(function (item2) {\r\n          if (item2 == current) {\r\n            item2.show = !item2.show;\r\n          } else {\r\n            item2.show = false;\r\n          }\r\n        });\r\n      });\r\n      this.resetDelStatus();\r\n    }\r\n  }\r\n});\r\n"]}