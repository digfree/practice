{"version":3,"sources":["test.js"],"names":["dataMock","name","children","url","show","DelItem","Vue","extend","props","template","data","startX","moveX","disX","methods","computeStyle","result","_touchStart","current","ev","event","w","$refs","remove","offsetWidth","_this","touches","length","style","match","String","preventDefault","item1","forEach","item","$set","clientX","_touchMove","_touchEnd","changedTouches","endX","deleteItem","index","splice","component","el","dataList","mounted","item2","resetDelStatus","item3","Number","toggle","toggle2"],"mappings":"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","file":"main.js","sourcesContent":["var dataMock = [\r\n  {\r\n    name: 2018,\r\n    children: [\r\n      {\r\n        name: \"2018-01\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"//baidu.com\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"//baidu.com\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        name: \"2018-02\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"//baidu.com\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"//baidu.com\"\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    name: 2017,\r\n    children: [\r\n      {\r\n        show: false,\r\n        name: \"2017-01\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"#\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"#\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        name: \"2017-02\",\r\n        children: [\r\n          {\r\n            name: \"文章1\",\r\n            url: \"#\"\r\n          },\r\n          {\r\n            name: \"文章2\",\r\n            url: \"#\"\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n];\r\n\r\nvar DelItem = Vue.extend({\r\n  props: ['item1', 'item2', 'index2'],\r\n  template: '<li ref=\"currentItem\">'\r\n    + '<a :href=\"item2.url\">'\r\n    + '<span class=\"del-btn\" @click.prevent=\"deleteItem(item1.children,index2)\" ref=\"remove\">删除</span>'\r\n    + '<p'\r\n    + '@touchstart=\"_touchStart(item2)\"'\r\n    + '@touchmove.prevent=\"_touchMove(item2)\"'\r\n    + '@touchend=\"_touchEnd(item2)\"'\r\n    + ':style=\"item2.style\">'\r\n    + '{{item2.name}}'\r\n    + '</p>'\r\n    + '</a>'\r\n    + '</li>',\r\n  data: function () {\r\n    return {\r\n      startX: 0, //触摸位置\r\n      moveX: 0, //滑动时的位置\r\n      disX: 0, //移动距离\r\n    };\r\n  },\r\n  methods: {\r\n    computeStyle: function (result) {\r\n      return 'transform: translateX(' + result + 'px)';\r\n    },\r\n    _touchStart: function (current) {\r\n      var ev = ev || event;\r\n      var w = this.$refs.remove.offsetWidth;\r\n      var _this = this;\r\n      if (ev.touches.length == 1) {\r\n        if (typeof current.style != 'undefined' && current.style != null && current.style.match(/\\d+/)[0] == String(w)) ev.preventDefault();\r\n        this.item1.children.forEach(function (item) {\r\n          if(item == current) return false;\r\n          if (typeof item.style != 'undefined' && item.style != null && item.style.match(/\\d+/)[0] == String(w)) {\r\n            _this.$set(item,'style',_this.computeStyle('0'));\r\n            ev.preventDefault();\r\n          }\r\n        });\r\n        this.startX = ev.touches[0].clientX;\r\n      }\r\n    },\r\n    _touchMove: function (current) {\r\n      var ev = ev || event;\r\n      var w = this.$refs.remove.offsetWidth;\r\n      if (ev.touches.length == 1) {\r\n        this.moveX = ev.touches[0].clientX;\r\n        this.disX = this.startX - this.moveX;\r\n        if (this.disX < 0 || this.disX == 0) {\r\n          this.$set(current,'style',this.computeStyle('0'));\r\n        } else {\r\n          this.$set(current,'style',this.computeStyle('-' + this.disX));\r\n          if (this.disX >= w) {\r\n            this.$set(current,'style',this.computeStyle('-' + w));\r\n          }\r\n        }\r\n      }\r\n    },\r\n    _touchEnd: function (current) {\r\n      var ev = ev || event;\r\n      var w = this.$refs.remove.offsetWidth;\r\n      if (ev.changedTouches.length == 1) {\r\n        var endX = ev.changedTouches[0].clientX;\r\n        this.disX = this.startX - endX;\r\n        if (this.disX < w / 2) {\r\n          this.$set(current,'style',this.computeStyle('0'));\r\n        } else {\r\n          this.$set(current,'style',this.computeStyle('-' + w));\r\n        }\r\n      }\r\n    },\r\n    deleteItem: function (item, index) {\r\n      item.splice(index, 1);\r\n    }\r\n  }\r\n});\r\n\r\nVue.component('del-item', DelItem);  //注册全局组件del-item\r\n\r\nnew Vue({\r\n  el: \"#el\",\r\n  data: {\r\n    dataList: [],\r\n  },\r\n  \r\n  mounted: function () {\r\n    var _this = this;\r\n    this.dataList = dataMock;\r\n    this.dataList.forEach(function (item) {\r\n      _this.$set(item, 'show', false);\r\n      item.children.forEach(function (item2) {\r\n        _this.$set(item2, 'show', false);\r\n      });\r\n    });\r\n    \r\n  },\r\n  methods: {\r\n    resetDelStatus: function () {\r\n      var _this = this;\r\n      this.dataList.forEach(function (item) {\r\n        item.children.forEach(function (item2) {\r\n          item2.children.forEach(function (item3) {\r\n            if(typeof item3.style != 'undefined' && Number(item3.style.match(/\\d+/)) != 0){\r\n              _this.$set(item3, 'style', 'transform: translateX(0px)');\r\n            }\r\n          });\r\n        });\r\n      });\r\n    },\r\n    toggle: function (current) {\r\n      this.dataList.forEach(function (item) {\r\n        if (item == current) {\r\n          item.show = !item.show;\r\n        } else {\r\n          item.show = false;\r\n        }\r\n        item.children.forEach(function (item2) {\r\n          if (item2.show) {\r\n            item2.show = false;\r\n          }\r\n        });\r\n      });\r\n      this.resetDelStatus();\r\n    },\r\n    toggle2(current) {\r\n      this.dataList.forEach(function (item) {\r\n        item.children.forEach(function (item2) {\r\n          if (item2 == current) {\r\n            item2.show = !item2.show;\r\n          } else {\r\n            item2.show = false;\r\n          }\r\n        });\r\n      });\r\n      this.resetDelStatus();\r\n    }\r\n  }\r\n});\r\n"]}